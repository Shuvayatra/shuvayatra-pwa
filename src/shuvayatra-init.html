<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-localstorage/iron-localstorage.html">
<link rel="import" href="shuvayatra-app.html">
<link rel="import" href="shuvayatra-onboard.html">
<dom-module id="shuvayatra-init">
    <template>
        <style>
            :host {
                --app-primary-color: #27a8d8;
                --app-secondary-color: black;
                display: block;
            }
        </style>
        <iron-localstorage name="onboard" value="{{onboard}}" on-iron-localstorage-load-empty="_initializeDefaultOnboard">
        </iron-localstorage>
        <template is="dom-if" if="{{ _showOnboard(onboard) }}">
            <shuvayatra-onboard></shuvayatra-onboard>
        </template>
        <template is="dom-if" if="{{ !_showOnboard(onboard) }}">
            <shuvayatra-app></shuvayatra-app>
        </template>
    </template>
    <script>
    	Polymer({
            is: 'shuvayatra-init',
            _showOnboard : function(onboard) {
	            var domainUrl = window.location.href == "https://app.shuvayatra.org/" || window.location.href == "https://app.shuvayatra.org/user";

	            return (!(onboard.status) && domainUrl);

	        },

	        getDomainUrl :  function(url){
	            var domain;
	            //find & remove protocol (http, ftp, etc.) and get domain
	            if (url.indexOf("://") > -1) {
	                domain = url.split('/')[2];
	            }
	            else {
	                domain = url.split('/')[0];
	            }

	            //find & remove port number
	            domain = domain.split(':')[0];

	            return domain;


	        },

	        _initializeDefaultOnboard : function(){
	            scope.onboard = {
	                dob:{},
	                status: false
	            };
	        }
        });
    </script>
</dom-module>